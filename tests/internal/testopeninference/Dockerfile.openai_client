# Copyright Envoy AI Gateway Authors
# SPDX-License-Identifier: Apache-2.0
# The full text of the Apache license is available in the LICENSE file at
# the root of the repo.

# Use glibc-based image with pre-compiled wheels for psutil
FROM python:3.13-slim

RUN python -m pip install --upgrade pip

RUN pip install openai \
    opentelemetry-sdk \
    opentelemetry-exporter-otlp-proto-http \
    opentelemetry-distro \
    opentelemetry-instrumentation-httpx \
    openinference-instrumentation-openai

ENTRYPOINT ["sh", "-c"]
# OpenInference only uses spans, not metrics or logs - disable them via CLI args
CMD ["opentelemetry-instrument --service_name openai-cli --metrics_exporter none --logs_exporter none openai api chat.completions.create -t 0 -m ${CHAT_MODEL} --message user 'Answer in up to 3 words: Which ocean contains Bouvet Island?'"]
